/* 基本スタイル、トップページ、クイズカード、レスポンシブなど、大部分は変更なし */
body { font-family: sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; }
#top-page-container { max-width: 900px; margin: 0 auto; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; }
header { background-color: #4a7c59; color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; }
.logo-container { display: flex; align-items: center; }
.logo-container img { width: 40px; height: 40px; margin-right: 15px; }
.logo-container h1 { font-size: 1.6em; margin: 0; }
.version-info { font-size: 0.9em; }
main { padding: 20px 30px; }
.app-summary { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
.app-summary p { line-height: 1.6; }
.quiz-selection h2, .app-settings h2 { font-size: 1.4em; color: #4a7c59; margin-bottom: 15px; }
.quiz-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
.quiz-card { border: 1px solid #ddd; border-radius: 8px; padding: 20px; display: flex; flex-direction: column; background-color: #fff; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; position: relative; justify-content: space-between;}
.quiz-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
.quiz-card-header { display: flex; align-items: center; margin-bottom: 10px; }
.quiz-card-icon { font-size: 1.8em; margin-right: 10px; }
.quiz-card-header h3 { margin: 0; font-size: 1.2em; flex-grow: 1; }
.quiz-card-clear-mark { font-size: 1.5em; color: #ffc107; }
.quiz-card p { flex-grow: 1; font-size: 0.9em; color: #555; margin-bottom: 15px; }
.quiz-card-footer { display: flex; justify-content: space-between; align-items: center; }
.quiz-card-highscore { font-size: 0.9em; font-weight: bold; color: #4a7c59; }
.challenge-btn { background-color: #4a7c59; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em; transition: background-color 0.3s; }
.challenge-btn:hover { background-color: #3b6347; }
.challenge-buttons-wrapper {
    display: flex;
    flex-direction: column; /* ボタンを、縦に、並べる */
    gap: 8px; /* ボタン間の、余白 */
    margin-left: auto; /* 右寄せにする */
}

.cram-mode-btn {
    background-color: #e67e22; /* 厳選モードは、オレンジ色に */
    border-color: #d35400;
}

.cram-mode-btn:hover {
    background-color: #d35400;
}

/* フッターの、レイアウトを、調整 */
.quiz-card-footer {
    display: flex;
    justify-content: space-between;
    align-items: flex-end; /* 要素を、下揃えに */
}
.quiz-container, .quiz-container-choujuu { display: none; max-width: 900px; margin: 0 auto; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px 30px; }
.answer-buttons-grid { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 20px; }
.answer-buttons-grid:has(> button:nth-child(4)) { grid-template-columns: 1fr 1fr; }
#submit, #choujuu-submit { margin-top: 20px; width: 100%; padding: 15px; font-size: 1.2em; font-weight: bold; background-color: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; }
.choujuu-image-container { width: 100%; max-width: 500px; margin: 0 auto 20px auto; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
.choujuu-image-container img { width: 100%; height: auto; display: block; }
#choujuu-step1 h2, #choujuu-step2 h2 { text-align: center; margin-bottom: 20px; }
.choujuu-step1-buttons { display: flex; justify-content: center; gap: 20px; }
.feedback-container { margin-top: 20px; padding: 15px; font-size: 1.2em; font-weight: bold; text-align: center; border-radius: 5px; display: none; }
.feedback-container.correct { background-color: #e8f5e9; color: #2e7d32; display: block; }
.feedback-container.wrong { background-color: #ffebee; color: #c62828; display: block; }
#loader-wrapper { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #2c3e50; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 3000; transition: opacity 0.5s ease; }
#loader-wrapper.loaded { opacity: 0; pointer-events: none; }
.loader { border: 8px solid #f3f3f3; border-top: 8px solid #3498db; border-radius: 50%; width: 60px; height: 60px; animation: spin 1.5s linear infinite; }
#loader-wrapper #progress-text { /* IDセレクタに、変更 */
    margin-top: 20px;
    color: #f3f3f3;
    font-size: 1.2em;
    min-height: 1.5em; /* テキストが、変わっても、ガタつかないように、高さを、確保 */
}
/* ★★★ ここからが、追加の、スタイル ★★★ */
.progress-container {
    width: 80%;
    max-width: 300px;
    height: 10px;
    background-color: #555;
    border-radius: 5px;
    margin-top: 25px;
    overflow: hidden;
}

#progress-bar {
    width: 0%; /* 初期値は、0% */
    height: 100%;
    background-color: #3498db;
    border-radius: 5px;
    transition: width 0.2s ease-out; /* 幅が、滑らかに、変化するように */
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.answer-btn, .choujuu-choice-btn { padding: 15px; font-size: 1em; cursor: pointer; border-radius: 8px; border: 2px solid #ccc; background-color: #f8f9fa; text-align: center; transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out, border-color 0.2s ease-in-out; }
.answer-btn:hover:not(:disabled), .choujuu-choice-btn:hover:not(:disabled) { background-color: #e9ecef; border-color: #999; }
.answer-btn.correct, .choujuu-choice-btn.correct { background-color: #28a745; color: white; border-color: #218838; transform: scale(1.05); }
.answer-btn.wrong, .choujuu-choice-btn.wrong { background-color: #dc3545; color: white; border-color: #c82333; opacity: 0.7; }
.answer-btn.reveal-correct { background-color: #17a2b8; color: white; border-color: #138496; }
.answer-btn:disabled, .choujuu-choice-btn:disabled { cursor: not-allowed; opacity: 0.9; }
.answer-btn:disabled:not(.correct):not(.wrong):not(.reveal-correct), .choujuu-choice-btn:disabled:not(.correct):not(.wrong) { opacity: 0.5; }
.quiz-header-bar { display: flex; justify-content: flex-start; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
.back-to-top-btn { background-color: transparent; border: 1px solid #ccc; color: #555; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.9em; transition: all 0.2s ease-in-out; }
.back-to-top-btn:hover { background-color: #f0f0f0; border-color: #999; color: #222; }
#result-container { display: none; max-width: 900px; margin: 0 auto; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px 30px; text-align: center; }
.result-header h2 { font-size: 1.8em; color: #4a7c59; margin-bottom: 20px; }
.result-summary { margin-bottom: 30px; }
#result-message { font-size: 1.5em; font-weight: bold; margin-bottom: 10px; }
#result-score { font-size: 1.2em; color: #555; }
.result-details { text-align: left; margin-bottom: 30px; padding-top: 20px; border-top: 1px solid #eee; }
.result-details h3 { font-size: 1.2em; margin-bottom: 15px; }
#wrong-questions-list { list-style-type: none; padding-left: 0; }
#wrong-questions-list li { background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 10px; }
#wrong-questions-list .question-text { font-weight: bold; margin-bottom: 8px; }
#wrong-questions-list .correct-answer-text { color: #28a745; }
#no-wrong-questions-message p { text-align: center; color: #555; padding: 20px; }
.result-actions { display: flex; justify-content: center; gap: 20px; }
#retry-quiz-btn, #back-to-top-from-result-btn { padding: 12px 25px; font-size: 1em; cursor: pointer; border-radius: 5px; border: none; transition: background-color 0.3s; }
#retry-quiz-btn { background-color: #4a7c59; color: white; }
#retry-quiz-btn:hover { background-color: #3b6347; }
#back-to-top-from-result-btn { background-color: #6c757d; color: white; }
#back-to-top-from-result-btn:hover { background-color: #5a6268; }
.app-settings { margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; }
.setting-item { background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 8px; padding: 20px; display: flex; justify-content: space-between; align-items: center; gap: 20px; }
.setting-item p { margin: 0; line-height: 1.5; color: #555; flex-grow: 1; }
.danger-btn { background-color: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 0.9em; font-weight: bold; transition: background-color 0.3s; flex-shrink: 0; }
.danger-btn:hover { background-color: #c82333; }
@media (max-width: 940px) { body { padding: 10px; } main { padding: 15px 20px; } }
@media (max-width: 768px) { header { flex-direction: column; text-align: center; gap: 10px; } .logo-container h1 { font-size: 1.3em; } .quiz-options { grid-template-columns: 1fr; } .quiz-card { padding: 15px; } .choujuu-choice-btn { width: 120px; padding: 15px; font-size: 1.2em; } .answer-buttons-grid:has(> button:nth-child(4)) { grid-template-columns: 1fr; } .setting-item { flex-direction: column; text-align: center; } }
@media (max-width: 480px) { body { padding: 5px; } main { padding: 10px; } .logo-container img { width: 30px; height: 30px; margin-right: 10px; } .logo-container h1 { font-size: 1.1em; } header { padding: 10px 15px; } }


.normal-quiz-image-container {
    width: 100%;
    max-width: 400px; /* 画像サイズを少し控えめに */
    margin: 0 auto 25px auto; /* 上下左右の余白を調整 */
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.normal-quiz-image-container img {
    width: 100%;
    height: auto;
    display: block;
}

.additional-info-container {
    margin-top: 25px;
    padding: 20px;
    background-color: #e9f7fd; /* 落ち着いた水色 */
    border: 1px solid #b3e5fc;
    border-radius: 8px;
}

.additional-info-container h4 {
    margin: 0 0 10px 0;
    font-size: 1.1em;
    color: #0277bd;
}

.additional-info-container p {
    margin: 0;
    line-height: 1.6;
    white-space: pre-wrap; /* 改行をそのまま表示する */
}
.quiz-header-bar {
    display: flex;
    justify-content: space-between; /* 要素を両端に配置 */
    align-items: center; /* 上下中央揃え */
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}
.quiz-progress {
    font-size: 1em;
    font-weight: bold;
    color: #555;
}
/* =================================================================== */
/* ★★★ クイズ進捗バー用のスタイル (ここから追加) ★★★ */
/* =================================================================== */
.progress-area {
    flex-grow: 1; /* ヘッダーバー内で可能な限り幅をとる */
    display: flex;
    align-items: center;
    gap: 15px; /* バーとテキストの間の余白 */
    margin-left: 20px; /* 戻るボタンとの余白 */
}

.progress-bar-container {
    flex-grow: 1;
    height: 18px;
    background-color: #e0e0e0; /* バーの背景色（薄いグレー） */
    border-radius: 9px; /* 角を丸くする */
    overflow: hidden; /* 中のバーがはみ出ないように */
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2); /* 内側に影をつけて立体感を出す */
}

.progress-bar-inner {
    height: 100%;
    width: 0%; /* 初期値は0% */
    background: linear-gradient(45deg, #4caf50, #81c784); /* グラデーションで楽しい見た目に */
    border-radius: 9px;
    transition: width 0.4s ease-in-out; /* 幅が滑らかに変化するアニメーション */
    text-align: right;
    color: white;
    font-size: 12px;
    line-height: 18px;
    padding-right: 8px;
    box-sizing: border-box;
}

.quiz-progress {
    font-size: 1.1em;
    font-weight: bold;
    color: #333;
    flex-shrink: 0; /* テキストが潰れないように */
}
/* =================================================================== */
/* ★★★ サウンド設定トグルスイッチ用のスタイル (ここから追加) ★★★ */
/* =================================================================== */
.sound-toggle-container {
    display: flex;
    align-items: center;
    gap: 10px;
}

.sound-icon {
    font-size: 1.5em;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #4a7c59; /* ONの時の色をテーマカラーに合わせる */
}

input:focus + .slider {
    box-shadow: 0 0 1px #4a7c59;
}

input:checked + .slider:before {
    transform: translateX(26px);
}
/* =================================================================== */
/* ★★★ 寿司クイズカード専用スタイル (ここから追加) ★★★ */
/* =================================================================== */
.quiz-card-footer-sushi {
    display: flex;
    flex-direction: column;
    gap: 10px; /* ボタン間の余白 */
    margin-top: 15px;
}

.challenge-btn-sushi {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 0; /* 内側の余白は子要素で調整 */
    border: 1px solid #4a7c59;
    background-color: #f8f9fa;
    border-radius: 8px;
    overflow: hidden; /* 角丸を維持 */
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    color: #333;
    font-weight: bold;
}

.challenge-btn-sushi:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.sushi-btn-label {
    padding: 12px 15px;
    background-color: #4a7c59;
    color: white;
    flex-grow: 1;
    text-align: center;
}

.sushi-btn-score {
    padding: 12px 15px;
    background-color: #e8f5e9;
    color: #4a7c59;
    min-width: 100px; /* スコア部分の最小幅を確保 */
    text-align: center;
    border-left: 1px solid #4a7c59;
}

/* マニアック（オタク）ボタンの特別スタイル */
.challenge-btn-sushi.cram-mode-btn {
    border-color: #e67e22;
}

.challenge-btn-sushi.cram-mode-btn .sushi-btn-label {
    background-color: #e67e22;
}

.challenge-btn-sushi.cram-mode-btn .sushi-btn-score {
    background-color: #fff3e0;
    color: #e67e22;
    border-left-color: #e67e22;
}
